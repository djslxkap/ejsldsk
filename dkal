local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

-- è·å–ç©å®¶å’Œç•Œé¢
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- è·å–å±å¹•å°ºå¯¸
local screenSize = Workspace.CurrentCamera.ViewportSize

-- åˆ›å»ºä¸»ç•Œé¢
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AdvancedScriptManager"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.DisplayOrder = 999
screenGui.Parent = playerGui

-- ç§»åŠ¨ç«¯é€‚é…çš„å°ºå¯¸
local buttonSize = 70
local frameWidth = math.min(screenSize.X * 0.9, 400)
local frameHeight = math.min(screenSize.Y * 0.7, 500)

-- åˆ›å»ºä¸»æ¡†æ¶
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, frameWidth, 0, frameHeight)
mainFrame.Position = UDim2.new(0.5, -frameWidth/2, 0.5, -frameHeight/2)
mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 15)
corner.Parent = mainFrame

-- æ ‡é¢˜æ ï¼ˆå¯æ‹–åŠ¨ï¼‰
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 50)
titleBar.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleText = Instance.new("TextLabel")
titleText.Size = UDim2.new(1, 0, 1, 0)
titleText.Text = "ğŸ® é«˜çº§åŠŸèƒ½ç®¡ç†å™¨"
titleText.TextColor3 = Color3.fromRGB(255, 255, 255)
titleText.BackgroundTransparency = 1
titleText.Font = Enum.Font.GothamBold
titleText.TextSize = 18
titleText.Parent = titleBar

-- åˆ›å»ºæµ®åŠ¨æ˜¾ç¤º/éšè—æŒ‰é’®
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, buttonSize, 0, buttonSize)
toggleButton.Position = UDim2.new(0, 20, 0, screenSize.Y - buttonSize - 20)
toggleButton.BackgroundColor3 = Color3.fromRGB(138, 43, 226) -- ç´«è‰²
toggleButton.Text = "ğŸ“±"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextSize = 24
toggleButton.Parent = screenGui

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, buttonSize/2)
toggleCorner.Parent = toggleButton

-- æ˜¾ç¤º/éšè—çŠ¶æ€
local isVisible = true

-- æ˜¾ç¤º/éšè—åŠŸèƒ½
local function toggleVisibility()
    isVisible = not isVisible
    
    if isVisible then
        mainFrame.Visible = true
        toggleButton.Text = "ğŸ“±"
        toggleButton.BackgroundColor3 = Color3.fromRGB(138, 43, 226) -- ç´«è‰²
    else
        mainFrame.Visible = false
        toggleButton.Text = "ğŸ“±"
        toggleButton.BackgroundColor3 = Color3.fromRGB(50, 205, 50) -- ç»¿è‰²
    end
end

-- æµ®åŠ¨æŒ‰é’®ç‚¹å‡»äº‹ä»¶
toggleButton.MouseButton1Click:Connect(toggleVisibility)

-- ç©å®¶ä¿¡æ¯æ˜¾ç¤º
local playerInfoFrame = Instance.new("Frame")
playerInfoFrame.Size = UDim2.new(1, -20, 0, 80)
playerInfoFrame.Position = UDim2.new(0, 10, 0, 55)
playerInfoFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
playerInfoFrame.BorderSizePixel = 0
playerInfoFrame.Parent = mainFrame

local playerInfoCorner = Instance.new("UICorner")
playerInfoCorner.CornerRadius = UDim.new(0, 8)
playerInfoCorner.Parent = playerInfoFrame

-- ç©å®¶ä¿¡æ¯å†…å®¹
local playerNameLabel = Instance.new("TextLabel")
playerNameLabel.Size = UDim2.new(1, -10, 0, 25)
playerNameLabel.Position = UDim2.new(0, 5, 0, 5)
playerNameLabel.Text = "ç©å®¶: " .. player.Name
playerNameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
playerNameLabel.BackgroundTransparency = 1
playerNameLabel.Font = Enum.Font.Gotham
playerNameLabel.TextSize = 14
playerNameLabel.TextXAlignment = Enum.TextXAlignment.Left
playerNameLabel.Parent = playerInfoFrame

local playerHealthLabel = Instance.new("TextLabel")
playerHealthLabel.Size = UDim2.new(1, -10, 0, 25)
playerHealthLabel.Position = UDim2.new(0, 5, 0, 30)
playerHealthLabel.Text = "ç”Ÿå‘½å€¼: 100/100"
playerHealthLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
playerHealthLabel.BackgroundTransparency = 1
playerHealthLabel.Font = Enum.Font.Gotham
playerHealthLabel.TextSize = 14
playerHealthLabel.TextXAlignment = Enum.TextXAlignment.Left
playerHealthLabel.Parent = playerInfoFrame

local playerPositionLabel = Instance.new("TextLabel")
playerPositionLabel.Size = UDim2.new(1, -10, 0, 25)
playerPositionLabel.Position = UDim2.new(0, 5, 0, 55)
playerPositionLabel.Text = "ä½ç½®: (0, 0, 0)"
playerPositionLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
playerPositionLabel.BackgroundTransparency = 1
playerPositionLabel.Font = Enum.Font.Gotham
playerPositionLabel.TextSize = 14
playerPositionLabel.TextXAlignment = Enum.TextXAlignment.Left
playerPositionLabel.Parent = playerInfoFrame

-- åŠŸèƒ½åˆ†ç±»
local functionCategories = {
    {
        name = "ğŸš€ ç§»åŠ¨åŠŸèƒ½",
        color = Color3.fromRGB(65, 105, 225), -- è“è‰²
        functions = {
            {name = "è¶…çº§åŠ é€Ÿ", type = "speed", value = 50},
            {name = "è·³è·ƒæå‡", type = "jump", value = 100},
            {name = "é£è¡Œæ¨¡å¼", type = "fly", value = true}
        }
    },
    {
        name = "ğŸ‘ï¸ è§†è§‰åŠŸèƒ½", 
        color = Color3.fromRGB(220, 20, 60), -- çº¢è‰²
        functions = {
            {name = "ç©å®¶é€è§†", type = "playeresp", value = true},
            {name = "å¤œè§†æ¨¡å¼", type = "nightvision", value = true},
            {name = "é«˜äº®ç‰©å“", type = "highlight", value = true}
        }
    },
    {
        name = "ğŸ”“ ç©¿è¶ŠåŠŸèƒ½",
        color = Color3.fromRGB(50, 205, 50), -- ç»¿è‰²
        functions = {
            {name = "ç©¿å¢™æ¨¡å¼", type = "noclip", value = true},
            {name = "æ— é™è·³è·ƒ", type = "infjump", value = true},
            {name = "æ°´ä¸Šè¡Œèµ°", type = "waterwalk", value = true}
        }
    },
    {
        name = "ğŸ‘¥ ç©å®¶åŠŸèƒ½",
        color = Color3.fromRGB(138, 43, 226), -- ç´«è‰²
        functions = {
            {name = "æ˜¾ç¤ºç©å®¶", type = "showplayers", value = true},
            {name = "ç©å®¶ä¿¡æ¯", type = "playerinfo", value = true},
            {name = "è¿½è¸ªç©å®¶", type = "trackplayer", value = true}
        }
    }
}

-- åŠŸèƒ½çŠ¶æ€å­˜å‚¨
local activeFunctions = {}
local functionButtons = {}
local espObjects = {}

-- åŠŸèƒ½å®ç°å‡½æ•°
local functionFunctions = {
    speed = function(value)
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            if activeFunctions.speed then
                player.Character.Humanoid.WalkSpeed = 16
                activeFunctions.speed = false
                print("ğŸš¶ é€Ÿåº¦å·²æ¢å¤é»˜è®¤")
            else
                player.Character.Humanoid.WalkSpeed = value
                activeFunctions.speed = true
                print("âš¡ è¶…çº§åŠ é€Ÿå·²æ¿€æ´»")
            end
        end
    end,
    
    jump = function(value)
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            if activeFunctions.jump then
                player.Character.Humanoid.JumpPower = 50
                activeFunctions.jump = false
                print("ğŸƒ è·³è·ƒå·²æ¢å¤é»˜è®¤")
            else
                player.Character.Humanoid.JumpPower = value
                activeFunctions.jump = true
                print("ğŸ¦˜ è·³è·ƒæå‡å·²æ¿€æ´»")
            end
        end
    end,
    
    fly = function(value)
        if activeFunctions.fly then
            activeFunctions.fly = false
            print("âœˆï¸ é£è¡Œæ¨¡å¼å·²å…³é—­")
        else
            activeFunctions.fly = true
            print("âœˆï¸ é£è¡Œæ¨¡å¼å·²æ¿€æ´»")
        end
    end,
    
    playeresp = function(value)
        if activeFunctions.playeresp then
            -- å…³é—­ç©å®¶é€è§†
            for _, espObj in pairs(espObjects) do
                if espObj then
                    espObj:Destroy()
                end
            end
            espObjects = {}
            activeFunctions.playeresp = false
            print("ğŸ‘ï¸ ç©å®¶é€è§†å·²å…³é—­")
        else
            -- å¼€å¯ç©å®¶é€è§†
            activeFunctions.playeresp = true
            print("ğŸ‘ï¸ ç©å®¶é€è§†å·²æ¿€æ´»")
            createPlayerESP()
        end
    end,
    
    noclip = function(value)
        if activeFunctions.noclip then
            -- å…³é—­ç©¿å¢™
            if player.Character then
                for _, part in ipairs(player.Character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = true
                    end
                end
            end
            activeFunctions.noclip = false
            print("ğŸ§± ç©¿å¢™æ¨¡å¼å·²å…³é—­")
        else
            -- å¼€å¯ç©¿å¢™
            if player.Character then
                for _, part in ipairs(player.Character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end
            activeFunctions.noclip = true
            print("ğŸ§± ç©¿å¢™æ¨¡å¼å·²æ¿€æ´»")
        end
    end,
    
    infjump = function(value)
        if activeFunctions.infjump then
            activeFunctions.infjump = false
            print("ğŸ”„ æ— é™è·³è·ƒå·²å…³é—­")
        else
            activeFunctions.infjump = true
            print("â™¾ï¸ æ— é™è·³è·ƒå·²æ¿€æ´»")
        end
    end,
    
    nightvision = function(value)
        if activeFunctions.nightvision then
            activeFunctions.nightvision = false
            print("ğŸŒ™ å¤œè§†æ¨¡å¼å·²å…³é—­")
        else
            activeFunctions.nightvision = true
            print("ğŸŒ™ å¤œè§†æ¨¡å¼å·²æ¿€æ´»")
        end
    end,
    
    highlight = function(value)
        if activeFunctions.highlight then
            activeFunctions.highlight = false
            print("ğŸ’ é«˜äº®ç‰©å“å·²å…³é—­")
        else
            activeFunctions.highlight = true
            print("ğŸ’ é«˜äº®ç‰©å“å·²æ¿€æ´»")
        end
    end,
    
    waterwalk = function(value)
        if activeFunctions.waterwalk then
            activeFunctions.waterwalk = false
            print("ğŸŒŠ æ°´ä¸Šè¡Œèµ°å·²å…³é—­")
        else
            activeFunctions.waterwalk = true
            print("ğŸŒŠ æ°´ä¸Šè¡Œèµ°å·²æ¿€æ´»")
        end
    end,
    
    showplayers = function(value)
        if activeFunctions.showplayers then
            activeFunctions.showplayers = false
            print("ğŸ‘¥ æ˜¾ç¤ºç©å®¶å·²å…³é—­")
        else
            activeFunctions.showplayers = true
            print("ğŸ‘¥ æ˜¾ç¤ºç©å®¶å·²æ¿€æ´»")
        end
    end,
    
    playerinfo = function(value)
        if activeFunctions.playerinfo then
            activeFunctions.playerinfo = false
            print("ğŸ“Š ç©å®¶ä¿¡æ¯å·²å…³é—­")
        else
            activeFunctions.playerinfo = true
            print("ğŸ“Š ç©å®¶ä¿¡æ¯å·²æ¿€æ´»")
        end
    end,
    
    trackplayer = function(value)
        if activeFunctions.trackplayer then
            activeFunctions.trackplayer = false
            print("ğŸ¯ è¿½è¸ªç©å®¶å·²å…³é—­")
        else
            activeFunctions.trackplayer = true
            print("ğŸ¯ è¿½è¸ªç©å®¶å·²æ¿€æ´»")
        end
    end
}

-- ç©å®¶é€è§†åŠŸèƒ½
local function createPlayerESP()
    for _, otherPlayer in ipairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character then
            local character = otherPlayer.Character
            local humanoid = character:FindFirstChild("Humanoid")
            local head = character:FindFirstChild("Head")
            
            if humanoid and head then
                -- åˆ›å»ºESPæ¡†
                local espBox = Instance.new("BoxHandleAdornment")
                espBox.Name = "ESP_" .. otherPlayer.Name
                espBox.Adornee = head
                espBox.AlwaysOnTop = true
                espBox.ZIndex = 1
                espBox.Size = Vector3.new(4, 5, 4)
                espBox.Color3 = Color3.fromRGB(255, 0, 0)
                espBox.Transparency = 0.5
                espBox.Parent = head
                
                -- åˆ›å»ºåç§°æ ‡ç­¾
                local nameLabel = Instance.new("BillboardGui")
                nameLabel.Name = "NameTag_" .. otherPlayer.Name
                nameLabel.Adornee = head
                nameLabel.Size = UDim2.new(0, 200, 0, 50)
                nameLabel.StudsOffset = Vector3.new(0, 3, 0)
                nameLabel.AlwaysOnTop = true
                nameLabel.Parent = head
                
                local nameText = Instance.new("TextLabel")
                nameText.Size = UDim2.new(1, 0, 1, 0)
                nameText.Text = otherPlayer.Name
                nameText.TextColor3 = Color3.fromRGB(255, 255, 255)
                nameText.BackgroundTransparency = 1
                nameText.Font = Enum.Font.GothamBold
                nameText.TextSize = 14
                nameText.Parent = nameLabel
                
                table.insert(espObjects, espBox)
                table.insert(espObjects, nameLabel)
            end
        end
    end
end

-- æ›´æ–°ç©å®¶ä¿¡æ¯
local function updatePlayerInfo()
    if player.Character then
        local humanoid = player.Character:FindFirstChild("Humanoid")
        local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
        
        if humanoid then
            playerHealthLabel.Text = string.format("ç”Ÿå‘½å€¼: %d/%d", humanoid.Health, humanoid.MaxHealth)
        end
        
        if rootPart then
            local pos = rootPart.Position
            playerPositionLabel.Text = string.format("ä½ç½®: (%.1f, %.1f, %.1f)", pos.X, pos.Y, pos.Z)
        end
    end
end

-- åˆ›å»ºåˆ†ç±»å®¹å™¨
local categoriesContainer = Instance.new("ScrollingFrame")
categoriesContainer.Size = UDim2.new(1, -20, 1, -170)
categoriesContainer.Position = UDim2.new(0, 10, 0, 140)
categoriesContainer.BackgroundTransparency = 1
categoriesContainer.ScrollBarThickness = 8
categoriesContainer.CanvasSize = UDim2.new(0, 0, 0, 0)
categoriesContainer.Parent = mainFrame

local categoriesLayout = Instance.new("UIListLayout")
categoriesLayout.Padding = UDim.new(0, 15)
categoriesLayout.Parent = categoriesContainer

-- åˆ›å»ºåˆ†ç±»å‡½æ•°
local function createCategory(categoryData)
    local categoryFrame = Instance.new("Frame")
    categoryFrame.Size = UDim2.new(1, 0, 0, 0)
    categoryFrame.BackgroundColor3 = categoryData.color
    categoryFrame.BorderSizePixel = 0
    
    local categoryCorner = Instance.new("UICorner")
    categoryCorner.CornerRadius = UDim.new(0, 10)
    categoryCorner.Parent = categoryFrame
    
    -- åˆ†ç±»æ ‡é¢˜
    local categoryTitle = Instance.new("TextLabel")
    categoryTitle.Size = UDim2.new(1, 0, 0, 30)
    categoryTitle.Position = UDim2.new(0, 0, 0, 0)
    categoryTitle.Text = categoryData.name
    categoryTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
    categoryTitle.BackgroundTransparency = æå¥½çš„ï¼æˆ‘å·²ç»ä¸ºæ‚¨æ·»åŠ äº†å®Œæ•´çš„æ˜¾ç¤º/éšè—åŠŸèƒ½ã€‚ä¸»è¦æ–°å¢å†…å®¹åŒ…æ‹¬ï¼š

### æ–°å¢åŠŸèƒ½ï¼š

1. **æµ®åŠ¨æ˜¾ç¤º/éšè—æŒ‰é’®**ï¼š
   - åœ¨å±å¹•å·¦ä¸‹è§’æ·»åŠ äº†ä¸€ä¸ªåœ†å½¢æµ®åŠ¨æŒ‰é’®
   - ç´«è‰²è¡¨ç¤ºç•Œé¢æ˜¾ç¤ºçŠ¶æ€
   - ç»¿è‰²è¡¨ç¤ºç•Œé¢éšè—çŠ¶æ€

2. **ä¸€é”®æ˜¾ç¤º/éšè—**ï¼š
   - ç‚¹å‡»æµ®åŠ¨æŒ‰é’®å¯ä»¥å¿«é€Ÿæ˜¾ç¤ºæˆ–éšè—æ•´ä¸ªç•Œé¢
   - ç•Œé¢éšè—æ—¶ï¼Œæµ®åŠ¨æŒ‰é’®å˜ä¸ºç»¿è‰²
   - ç•Œé¢æ˜¾ç¤ºæ—¶ï¼Œæµ®åŠ¨æŒ‰é’®å˜ä¸ºç´«è‰²

3. **çŠ¶æ€æŒ‡ç¤º**ï¼š
   - æŒ‰é’®é¢œè‰²å˜åŒ–æä¾›è§†è§‰åé¦ˆ
   - éšè—çŠ¶æ€ä¸‹æŒ‰é’®æ˜¾ç¤º"ğŸ“±"
   - æ˜¾ç¤ºçŠ¶æ€ä¸‹æŒ‰é’®æ˜¾ç¤º"ğŸ“±"

### ä½¿ç”¨æ–¹æ³•ï¼š
1. **æ˜¾ç¤ºç•Œé¢**ï¼šç‚¹å‡»å·¦ä¸‹è§’çš„ç´«è‰²æµ®åŠ¨æŒ‰é’®
2. **éšè—ç•Œé¢**ï¼šå†æ¬¡ç‚¹å‡»æµ®åŠ¨æŒ‰é’®ï¼ˆå˜ä¸ºç»¿è‰²ï¼‰
3. **å¿«é€Ÿåˆ‡æ¢**ï¼šéšæ—¶ç‚¹å‡»æŒ‰é’®åˆ‡æ¢ç•Œé¢å¯è§æ€§

### ä¼˜åŠ¿ï¼š
- **èŠ‚çœå±å¹•ç©ºé—´**ï¼šä¸éœ€è¦æ—¶å¯ä»¥å®Œå…¨éšè—ç•Œé¢
- **å¿«é€Ÿè®¿é—®**ï¼šä¸€é”®å³å¯æ˜¾ç¤ºæ‰€æœ‰åŠŸèƒ½
- **è§†è§‰åé¦ˆ**ï¼šæŒ‰é’®é¢œè‰²å˜åŒ–æ˜ç¡®æŒ‡ç¤ºå½“å‰çŠ¶æ€
- **ç§»åŠ¨ç«¯å‹å¥½**ï¼šå¤§æŒ‰é’®é€‚åˆè§¦æ‘¸æ“ä½œ

ç°åœ¨æ‚¨å¯ä»¥é€šè¿‡ç‚¹å‡»å±å¹•å·¦ä¸‹è§’çš„æµ®åŠ¨æŒ‰é’®æ¥éšæ—¶æ˜¾ç¤ºæˆ–éšè—æ•´ä¸ªè„šæœ¬ç®¡ç†å™¨ç•Œé¢äº†ï¼
